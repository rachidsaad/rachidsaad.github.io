<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Reddit</title>
	<link rel="stylesheet" href="style.css">
	<script src="https://code.jquery.com/jquery-3.2.1.js"></script>
	<script src="https://paste.imirhil.fr/js/sjcl-1.0.4.js"></script>
	<script src="https://paste.imirhil.fr/js/base64-2.1.9.js"></script>
	<script src="https://paste.imirhil.fr/js/rawdeflate-0.5.js"></script>
	<script src="https://paste.imirhil.fr/js/rawinflate-0.3.js"></script>

</head>
<body>
	<span class="icones icon-cancel"></span>
	<div class="switsh">
		<ul>
			<li class='icones icon-night'></li>
			<li class='icones icon-light'></li>
			<li class='icones icon-up' id='top'></li>
			<li class='icones icon-search' id='showsearch'></li>
			<span id='search'>
				<li><input type="text" placeholder="Novel Name" id='textfield'></li>
				<li class="icones icon-search" id="reddit_search"></li>
			</span>
		</ul>
	</div>

	<div id="wrap">

		<header>
			<a href="index.html"><img src="img/qw.png" alt=""><h1>UndeRGrounD</h1></a>
			<p>A greedy father has thieves for children.</p>
			<!-- <div id="confiozesearsh">
				<span id="search">
					<input type="text" placeholder="Novel Name" id='textfield'>
					<p class="icones icon-search" id="reddit_search"></p>
				</span>
				<p class="icones icon-search" id="showsearch"></p>
			</div> -->
		</header>

		<div id="search_results" class="updates">
			<ul>
				<li>
					<h1>Search results:</h1>
					<img id="spin" src="imgs/spin.gif" alt="">
				</li>
			</ul>
		</div>

		<div id="main">

			<div id="novelsearsh" class="updates">
				<ul>
					<li>
						<img id="spin" src="imgs/spin.gif" alt="">
						<span class='icones icon-cancel'></span>
					</li>
					<li></li>
				</ul>
			</div>

			<div id="novelinfo" class="updates">
				<ul>
					<li>
						<h1></h1>
						<span class='icones icon-cancel'></span>
					</li>
				</ul>
			</div>

			<div id="updates" class="updates">
				<ul>
					<li>
						<h1>
							<span class='icones icon-refresh' data-action='ReFresh'>
							</span>Latest Updates:
						</h1>
						<img id="spin" src="imgs/spin.gif" alt="">
					</li>
				</ul>
			</div>
		</div>

		<div id="side">
			<div id="novellist" class="updates">
				<ul>
					<li><h1>Novel list:</h1></li>
				</ul>
			</div>
		</div>

	</div>

	<div id="reader">

		<span class="icones icon-cancel"></span>
		<div class="text"></div>

	</div>

	<script src="main.js"></script>
	<script>
		$(document).ready(function(){
			var link  = 'https://www.reddit.com/r/QidianUnderground/new.json?',
				limit = 30;
			getData(link,limit,'updates');
			
			// novelList(link,'60','novellist');

			$('.icon-refresh').on('click', function(){
				var divID = $(this).parents('.updates').attr('id');
				$('img#spin').show();
				$('#'+divID+ ' ul li:gt(0)').remove()
				getData(link, limit, divID);							
			});

			$('#showsearch').on('click', function(){
				$('#search').toggle();
				$(this).toggleClass('icon-cancel');
				$('#textfield').val('').css('background','');
				$('#textfield').focus();

				$('#main').show();
				$('#search_results').hide();
				$('#search_results ul li:gt(0)').remove();
			});

			$('#reddit_search').on('click', function(){
				var textfield    = $('#textfield'),
					textfieldVal = $(textfield).val().trim();

					if(textfieldVal && !$.isNumeric(textfieldVal)){
						textfield.css('background','');
										
						$('#main').hide();
						$('#search_results').show();
						$('#search_results ul li:gt(0)').remove();
						$('#search_results li:eq(0) img').show();
						getLatest(textfieldVal, 30,'search_results');
					}else{
						textfield.css('background','#F44336');
						textfield.val('').focus();
					}
			});

			$('.switsh ul li').on('click', function(){
				if($(this).hasClass('icon-night')){
					$('body, header a, .switsh, .icon-search, #reader span.icon-cancel, #search input[type="text"], .updates, span.numbers, #reader, .text').addClass('night');
					$("header img").attr("src","img/qb.png");
					$(".icon-light").css('display','initial');
					$(this).hide();
					
				}else if($(this).hasClass('icon-light')){
					$('body, header a, .switsh, .icon-search, #reader span.icon-cancel, #search input[type="text"], .updates, span.numbers, #reader, .text').removeClass('night');
					$("header img").attr("src","img/qw.png");
					$(".icon-night").show();
					$(this).hide();

				}else if($(this).hasClass('icon-up')){
					$('body,html').animate({scrollTop:0},500);
				}

			});

			$(window).on('scroll',function(){
				$(window).scrollTop()>=400?$('#top').css('display','initial'):$('#top').hide();
			});
		});
	</script>
</body>
</html>